<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv='X-UA-Compatible' content='IE=edge' />
		<meta http-equiv='content-type' content='text/html; charset=utf-8'/>

		<style>
			body {
				font-size: 110%;
			}

			.changelog {
				display: none;
			}

			.version {
				padding: 0.2em;
				font-weight: bold;
			}

			.version-current {
				color: #000;
				font-weight: bold;
			}

			.version-new {
				color: #518BDB;
				font-weight: bold;
			}

			.version-block {
				border-bottom: 1px solid #518BDB;
			}

			.version-block div {
				margin: 0.7em 0em;
			}

			.version-block {
				border-left: 4px solid #518BDB;
				padding-left: 1em;
			}
		</style>

		<script>
		function toggleChangelog(classname) {
			var element = document.getElementById(classname);
			if (element.style.display !== 'block') {
				element.style.display = 'block';
			} else {
				element.style.display = 'none';
			}
		}
		</script>
	</head>
	<body>
		{% macro show_chagelog(id, appInfo)%}
			<!-- {{id}} version changelog -->
			<div id="{{id}}-changelog" class="changelog">
				<h3>{{str_version_history}}</h3>

				{% for version in appInfo.versionsList %}
				<h4>{{version.version}} {{(version.date)}}</h4>
				<ul>
					{% for change in version.changes %}
					<li>{{change}}</li>
					{% endfor %}
				</ul>
				{% endfor %}
			</div>
		{%- endmacro %}


        {% macro install_info(id, appInfo)%}
		{% set update_url = appInfo.versionsList[0].downloads %}
        <div class="controls">
			<a href="plugin_install:{{id}}" title="{{str_install}}">
                <img src="file://{{data_path}}/plugin_install.png" alt="{{str_install}}"></a>
            <a href="#" onclick="toggleChangelog('{{id}}-changelog');" title="{{str_more_info}}">
                <img src="file://{{data_path}}/plugin_info.png" alt="{{str_more_info}}"></a>
        </div>
            {{ show_chagelog(id, appInfo)}}
        {%- endmacro %}


		{% for pluginName, pluginInfo in installerInfoDict.items() %}
                <!-- {{pluginName}} block begin -->
                <div class="version-block plugin-version {{pluginName|replace(' ', '_')}}">
                    <div class="title"><a href="{{pluginInfo.appwebsite}}">{{pluginName}}</a></div>
                    <div>{{escape(pluginInfo.description)}}</div>
                    {{ install_info(pluginName, pluginInfo) }}
                </div>
                <!-- {{pluginName}} block end -->
		{% endfor %}

	</body>
</html>
